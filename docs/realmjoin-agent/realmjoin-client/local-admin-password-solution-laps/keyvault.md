# KeyVault

Cloud applications and services use cryptographic keys and secrets to help keep information secure. Azure Key Vault safeguards these keys and secrets. When you use Key Vault, you can encrypt authentication keys, storage account keys, data encryption keys, .pfx files, and passwords by using keys that are protected by hardware security modules.

## Create KeyVault

The following table shows the steps for the creation of Azure KeyVault and the configuration of Access Policy for RealmJoin LAPS:

| Task                                                                                                                                                                                                                                                                                                                               | Image                                                                                                           |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------- |
| 1. Open [Azure Portal](https://portal.azure.com)                                                                                                                                                                                                                                                                                   |                                                                                                                 |
| 2. Start with **Create a resource**                                                                                                                                                                                                                                                                                                | ![](<../../../.gitbook/assets/image (277).png>)                                                                 |
| 3. Type in **Key Vault** in the search field                                                                                                                                                                                                                                                                                       | ![](<../../../.gitbook/assets/image (274).png>)                                                                 |
| 4. On the detail page click **Create**                                                                                                                                                                                                                                                                                             |                                                                                                                 |
| <p>5. Fill out the required fields on the Basic Tab.<br><br>Please make sure to use a distinct naming scheme for the KeyVault URL.<br><br>For example: <em>rj-[tenant]-[service]</em> </p><p>Note: This is a DNS name, so global unique <br><br>Press <strong>Next</strong>.</p>                                                   | ![](<../../../.gitbook/assets/image (66).png>)                                                                  |
| <p>6. Access configuration<br><br>Please choose <strong>"Vault access policy"</strong> for Permission model.</p>                                                                                                                                                                                                                   | <div><figure><img src="../../../.gitbook/assets/image (25).png" alt=""><figcaption></figcaption></figure></div> |
| <p>7. Create an Access Policy for RealmJoin<br><br>Press <em><strong>Create</strong></em> and choose <strong>"Key, Secret &#x26; Certificate Management"</strong> as template.<br><br>Additional add <em><strong>"Select all"</strong></em> for <strong>Cryptographic Operations.</strong><br><br>Press <strong>Next</strong>.</p> | <div><figure><img src="../../../.gitbook/assets/image (26).png" alt=""><figcaption></figcaption></figure></div> |
| <p>8. Add "RealmJoin" as Principal <br><br>Press <strong>Next</strong>.</p>                                                                                                                                                                                                                                                        |                                                                                                                 |
| 9. Click **Create**                                                                                                                                                                                                                                                                                                                |                                                                                                                 |
| 10. Review your settings and configurations and click **Review + Create**                                                                                                                                                                                                                                                          |                                                                                                                 |
| 11. Wait for the successful deployment                                                                                                                                                                                                                                                                                             |                                                                                                                 |
| 12. Click **Go to resource**                                                                                                                                                                                                                                                                                                       |                                                                                                                 |
| 13. Finally, go to **Overview** and share the **DNS Name** with the [RealmJoin Support](mailto:support@realmjoin.com)                                                                                                                                                                                                              | ![](<../../../.gitbook/assets/image (57).png>)                                                                  |

## KeyVault Storage of Secrets

RealmJoin will not store the secret in any proprietary storage but instead create an **Azure KeyVault Secret** to store it in a secure and auditable way. The KeyVault API is documented here:

[https://docs.microsoft.com/en-us/rest/api/keyvault/secrets/set-secret/set-secret](https://docs.microsoft.com/en-us/rest/api/keyvault/secrets/set-secret/set-secret)

The entry in KeyVault will be added with the Azure device ID as a key and the plain GUID as the secret value. See the following example:

![](<../../../.gitbook/assets/image (190).png>)

![](<../../../.gitbook/assets/image (191).png>)
